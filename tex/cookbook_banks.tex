%-------------------------------------------------------------------------------
% cookbook_banks
%-------------------------------------------------------------------------------
%
% \file        cookbook_banks.tex
% \library     Documents
% \author      Chris Ahlstrom
% \date        2015-07-12
% \update      2015-07-14
% \version     $Revision$
% \license     $XPC_GPL_LICENSE$
%
%     Provides the cookbooks_banks section of yoshimi-cookbook.tex.
%
%-------------------------------------------------------------------------------

\section{Banks and General MIDI}
\label{sec:cookbook_banks}

   Banks are discussed quite heavily in the user manual \cite{yoshimidoc}.
   Banks have evolved quite a bit in \textsl{Yoshimi}, and are
   a powerful way to manage instruments, and more amenable to automation
   than ever.

   In this section, we will attempt to set up a basic bank that is
   compliant with the General MIDI specification.  In order to do so, we
   will cherry pick instruments from the package that is provided when
   \textsl{Yoshimi} is installed, renaming them as needed to fit into the
   appropriate General MIDI slot.

   One problem is the selection of the \textsl{best} instrument for a given
   General MIDI program number.  There are simply too many to be able to
   evaluate them all.

   For this recipe, the \texttt{banks} and \texttt{presets} directories will
   be stored in the following directory of this project:

   \begin{verbatim}
      yoshimi/gm/basic
   \end{verbatim}

\subsection{Creating a Basic GM Bank}
\label{subsec:cookbook_banks_basic_gm}

   Creating even a basic General MIDI bank is beset with issues, even if one
   has at hand a large number of pre-built instruments.

   First, what is the purpose of the General MIDI specific?  To provide a
   dependable set of instruments so that tunes will sound basically similar
   on different GM-compliant synthesizers.  That's about it.  It doesn't
   guarantee that the sounds are consistent, nor does it guarantee that they
   are all of high quality.  The "FX", "Lead", and "Pad" instruments provide
   ambiguous descriptions that a wide range of sounds might fit.
   Getting a complete and high-quality set of sounds is extremely difficult.

   Second, evaluating a large number of pre-built instruments takes a lot of
   work.  We'd done some of this work for another project, and never
   finished.  Nor is the naming of such instruments all that helpful; many
   of the file-names are misleading.  Finding decent matches for a GM
   instrument takes time.

   Third, there are many GM instruments for which we've been able to find no
   good \textsl{ZynAddSubFX}/\textsl{Yoshimi} counterpart.  The only options
   are to pick a tolerable match, build a tolerable match oneself, or just
   plug in any old sound and wait for others to step up.

   Nonetheless, let's forge ahead.  The project file
   \texttt{contrib/instrument.ods} is a \textsl{LibreOffice} spreadsheet
   that represents some research in finding GM-compatible instruments.
   It's pretty bad; maybe 50\% useful.

   We converted it to \texttt{contrib/gmcopy} to copy the files
   into the project directory \texttt{yoshimi/banks/gm/basic}.
   We show the banks in table~\ref{table:gm_basic_files}
   for convenience.

\input{gm_basic_table}

   Presumably, this basic bank could be improved enough to be useful
   for most music.  Alternative (and better) banks could be created, as
   well.

\subsection{Root Paths}
\label{subsec:cookbook_banks_root_paths}

   The first thing to do is to add the yoshimi-cookbook banks directory to 
   your setup.

   Run \textsl{Yoshimi}, and navigate the following user-interface path:
   \textsl{Menu / Instrument / Show Root Paths ...}

   Then click \textbf{Add root directory...}.  Navigate to where the
   yoshimi-cookbook project is stored and add the \texttt{yoshimi/gm}
   directory.  The result should be something like the following:

\begin{figure}[H]
   \centering 
   \includegraphics[scale=1.0]{menu/Instrument/bank_root_paths.png}
   \caption{Bank Root Paths}
   \label{fig:cookbook_bank_root_paths}
\end{figure}

   Click on the new directory.
   It has ID = 2 in that diagram.  We will refer to this value as
   the "GM path ID", and the actual path as the "GM path".
   Now click the \textbf{Make current} button.
   Verify that it now has the asterisk. 
   Click the \textbf{Save and Close} button.

   Now let's open the "basic" bank.
   Run \textsl{Yoshimi}, and navigate the following user-interface path:
   \textsl{Menu / Instrument / Show Banks ...}

   In the matrix of banks, you should see "basic" somewhere (we see only
   "42. basic" in our list, as in the following figure).

\begin{figure}[H]
   \centering 
   \includegraphics[scale=1.0]{menu/Instrument/solitary_basic_bank.png}
   \caption{One Basic Bank}
   \label{fig:cookbook_bank_solitary_bank}
\end{figure}
   
   Click on the basic bank.  The larger dialog below will be shown.

\begin{figure}[H]
   \centering 
   \includegraphics[scale=1.0]{menu/Instrument/banks_gm_basic.png}
   \caption{A General MIDI Basic Bank}
   \label{fig:cookbook_bank_basic_bank}
\end{figure}

Remember that these banks have GM names; the original files used to create
each one are listed in the spreadsheet mentioned in the previous section.

Also note the drum kit, with an ID of 129.  Normally, drum kits might be
stored in a bank of drum kits, but here we have a GM-compliant drum kit,
compliant in the sense that most of the keys are mapped correctly,
and all keys will play \textsl{something}.

%-------------------------------------------------------------------------------
% vim: ts=3 sw=3 et ft=tex
%-------------------------------------------------------------------------------
